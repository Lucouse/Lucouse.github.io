var Api=function(){function d(a,c,b){fetch(a).then(function(b){if(c===e.json)return b.json();if(c===e.text)return b.text()}).then(function(a){b(a)}).catch(function(b){message.alertMessage(b,null);console.error(b)})}var e={json:"json",text:"text",html:"html",css:"css",xml:"xml"};return{getComponent:function(a,c,b){a=util.buildUrl(["Lucouse.github.io","component",a,c]);d(a,e.text,function(a){b(a)})},getComponentList:function(a){var c=util.buildUrl(["Lucouse.github.io","list.json"]);d(c,e.json,function(b){a(b)})},
download:d,getProjectInfo:function(a){var c=util.buildUrl(["Lucouse.github.io","project.json"]);d(c,e.json,function(b){a(b)})}}},api=new Api,Util=function(){function d(a){var c=(new JSZip).folder(a.folder.name);c.file(a.folder.file[0].name,a.folder.file[0].value);c.file(a.folder.file[1].name,a.folder.file[1].value);c.generateAsync({type:"base64"}).then(function(b){location.href="data:application/zip;base64,"+b})}function e(a,c){var b="",f;for(f in a)b=b+a[f]+";";c(b)}return{buildDom:function(a){var c=
a.length;a.forEach(function(b,f){f+1<c&&b.appendChild(a[f+1])})},downloadComponent:function(a){api.getComponent(a,"index.html",function(c){api.getComponent(a,"index.css",function(b){d({folder:{name:a,file:[{name:"index.html",value:c},{name:"index.css",value:b}]}})})})},buildZip:d,buildUrl:function(a){var c="";a.forEach(function(b){c=c+"/"+b});return c},buildMailToAddress:function(a,c){var b="MailTo:";e(a.address,function(f){b=b+f+"?";b=b+"subject="+a.subject+"&";e(a.cc,function(f){""!==f&&(b=b+"cc="+
f+"&");e(a.bcc,function(h){""!==f&&(b=b+"bcc="+h+"&"+a.body);b=b+"body="+a.body;c(b)})})})}}},util=new Util;
window.onload=function(d){function e(c){c.forEach(function(b){api.getComponent(b.id,"index.html",function(c){var f=document.createElement("div"),h=document.createElement("h3"),e=document.createElement("div"),d=document.createElement("div");f.setAttribute("class","main-panel");h.innerText=b.name_cn;e.innerHTML=c.replace("index.css","component/"+b.id+"/index.min.css");d.setAttribute("class","component-tooBar");a(d,b.id);c=[document.getElementById("container"),f,h,e,d];util.buildDom(c)})})}function a(a,
b){var c=document.createElement("div"),e=document.createElement("div"),d=document.createElement("i"),g=document.createElement("div"),m=document.createElement("div"),k=document.createElement("i");c.setAttribute("id","icon-panel");d.setAttribute("class","i_download tooltip");d.setAttribute("data-tooltip","\u4e0b\u8f7d");d.onclick=function(a){util.downloadComponent(b)};g.setAttribute("id","icon-panel");k.setAttribute("class","i_feedback tooltip");k.setAttribute("data-tooltip","\u53cd\u9988");var l=document.createElement("a");
util.buildMailToAddress({address:["aaa@a.com","bbb@b.com"],subject:"test",cc:[],bcc:[],body:"test"},function(b){l.setAttribute("href",b)});document.body.appendChild(l);k.onclick=function(b){l.click()};util.buildDom([a,c,e,d]);util.buildDom([a,g,m,k])}api.getComponentList(function(a){e(a)});api.getProjectInfo(function(a){var b=document.getElementsByClassName("header")[0],c=document.createElement("div"),d=document.createElement("h2"),e=document.createElement("div"),g=document.createElement("div");d.innerText=
a.projectName;e.innerText=a.version;g.innerText=a.latestUpdateDate;c.setAttribute("class","project-info");util.buildDom([b,c]);util.buildDom([c,d]);util.buildDom([c,e]);util.buildDom([c,g])})};
