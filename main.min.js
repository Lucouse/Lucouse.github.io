var Api=function(){function e(d,a,c){fetch(d).then(function(b){if(a===f.json)return b.json();if(a===f.text)return b.text()}).then(function(b){c(b)}).catch(function(b){message.alertMessage(b,null);console.error(b)})}var f={json:"json",text:"text",html:"html",css:"css",xml:"xml"};return{getComponent:function(d,a,c){d=util.buildUrl(["Lucouse.github.io","component",d,a]);e(d,f.text,function(b){c(b)})},getComponentList:function(d){var a=util.buildUrl(["Lucouse.github.io","list.json"]);e(a,f.json,function(c){d(c)})},
download:e,getProjectInfo:function(d){var a=util.buildUrl(["Lucouse.github.io","project.json"]);e(a,f.json,function(c){d(c)})}}},api=new Api,Util=function(){function e(a){var c=a.length;a.forEach(function(b,d){d+1<c&&b.appendChild(a[d+1])})}function f(a){var c=(new JSZip).folder(a.folder.name);c.file(a.folder.file[0].name,a.folder.file[0].value);c.file(a.folder.file[1].name,a.folder.file[1].value);c.generateAsync({type:"base64"}).then(function(b){location.href="data:application/zip;base64,"+b})}function d(a,
c){var b="",d;for(d in a)b=b+a[d]+";";c(b)}return{buildDom:e,downloadComponent:function(a){api.getComponent(a,"index.html",function(c){api.getComponent(a,"index.css",function(b){f({folder:{name:a,file:[{name:"index.html",value:c},{name:"index.css",value:b}]}})})})},buildZip:f,buildUrl:function(a){var c="";a.forEach(function(b){c=c+"/"+b});return c},buildMailToAddress:function(a,c){var b="MailTo:";d(a.address,function(k){b=b+k+"?";b=b+"subject="+a.subject+"&";d(a.cc,function(h){""!==h&&(b=b+"cc="+
h+"&");d(a.bcc,function(d){""!==h&&(b=b+"bcc="+d+"&"+a.body);b=b+"body="+a.body;c(b)})})})},buildIcon:function(a,c,b){var d=document.createElement("div"),h=document.createElement("div"),g=document.createElement("i");d.setAttribute("id","icon-panel");g.setAttribute("class",c.iconClass+" tooltip");g.setAttribute("data-tooltip",c["data-tooltip"]);e([a,d,h,g]);void 0!==b&&b(g)}}},util=new Util;
window.onload=function(e){function f(c){c.forEach(function(b){api.getComponent(b.id,"index.html",function(c){var a=document.createElement("div"),g=document.createElement("h3"),e=document.createElement("div"),f=document.createElement("div");a.setAttribute("class","main-panel");g.innerText=b.name_cn;e.innerHTML=c.replace("index.css","component/"+b.id+"/index.min.css").replace("index.js","component/"+b.id+"/index.min.js");f.setAttribute("class","component-tooBar");d(f,b.id);util.buildDom([document.getElementById("container"),
a,g]);util.buildDom([a,e]);util.buildDom([a,f])})})}function d(c,b){util.buildIcon(c,{iconClass:"i_download","data-tooltip":"\u4e0b\u8f7d"},function(a){a.onclick=function(a){util.downloadComponent(b)}});var d=document.createElement("div"),f=document.createElement("div"),e=document.createElement("i");d.setAttribute("id","icon-panel");e.setAttribute("class","i_feedback tooltip");e.setAttribute("data-tooltip","\u53cd\u9988");var l=document.createElement("a");util.buildMailToAddress({address:["aaa@a.com",
"bbb@b.com"],subject:"test",cc:[],bcc:[],body:"test"},function(a){l.setAttribute("href",a)});document.body.appendChild(l);e.onclick=function(a){l.click()};var n=document.createElement("div"),p=document.createElement("div"),m=document.createElement("i");n.setAttribute("id","icon-panel");m.setAttribute("class","i_new_window tooltip");m.setAttribute("data-tooltip","\u65b0\u7a97\u53e3\u6253\u5f00");m.onclick=function(c){a(b)};util.buildDom([c,d,f,e]);util.buildDom([c,n,p,m])}function a(a){cover.showCover();
var b=document.createElement("div"),c=document.createElement("h3"),d=document.createElement("div"),e=document.createElement("div");b.appendChild(c);b.appendChild(d);b.appendChild(e);api.getComponent(a,"index.html",function(f){d.innerHTML=f.replace("index.css","component/"+a+"/index.min.css").replace("index.js","component/"+a+"/index.min.js");api.getComponentList(function(b){for(var d in b)if(b[d].id===a){c.innerHTML=b[d].name_cn;var f=void 0,g=b[d].compatibility,h=e,k="",l="";for(f in g){switch(g[f]){case "weChat":k=
"i_wechat";l="\u5fae\u4fe1";break;case "chrome":k="i_chrome";l="Chrome";break;case "firefox":k="i_firefox";l="\u706b\u72d0";break;case "ie":k="i_wechat";l="\u5fae\u4fe1";break;case "edge":k="i_edge",l="Edge"}util.buildIcon(h,{iconClass:k,"data-tooltip":l})}}});popUp.showPopUp(void 0,"custom-popUp-win",b)})}api.getComponentList(function(a){f(a)});api.getProjectInfo(function(a){var b=document.getElementsByClassName("header")[0],c=document.createElement("div"),d=document.createElement("h2"),e=document.createElement("div"),
f=document.createElement("div");d.innerText=a.projectName;e.innerText=a.version;f.innerText=a.latestUpdateDate;c.setAttribute("class","project-info");util.buildDom([b,c]);util.buildDom([c,d]);util.buildDom([c,e]);util.buildDom([c,f])})};
var Cover=function(){var e=document.createElement("div"),f=document.body;return{showCover:function(d){void 0!=d&&(f=d);e.setAttribute("class","cover");f.appendChild(e)},removeCover:function(){f.removeChild(e)}}},cover=new Cover,Message=function(){function e(d){d.fadeOut(800,function(){d.remove()})}function f(d,a){var c=$("<div></div>");a=$("<div></div>");var b=$("<div></div>");a.text("X");c.attr("class","message-container");a.attr("class","message-close");a.click(function(){e(c)});b.html(d);c.append(a);
c.append(b);c.fadeOut(8E3,function(){c.remove()});return c}return{type:{success:"success",error:"error",info:"info",warning:"warning"},alertMessage:function(d,a){$(document.body).append(f(d,a))}}},message=new Message,PopUp=function(){return{showPopUp:function(e,f,d){cover.showCover();void 0==e&&(e=document.body);var a=document.createElement("div"),c=document.createElement("div"),b=document.createElement("div"),k=document.createElement("div"),h=document.createElement("i"),g=document.createElement("div");
c.setAttribute("class","close-button-container");b.setAttribute("id","icon-panel");h.setAttribute("class","i_shut");c.appendChild(b).appendChild(k).appendChild(h);void 0!==f?a.setAttribute("class",f):a.setAttribute("class","popUpWin");g.setAttribute("class","popUp-content");e.appendChild(a).appendChild(c);a.appendChild(g).appendChild(d);h.onclick=function(b){e.removeChild(a);cover.removeCover()}}}},popUp=new PopUp;
