var Api=function(){function d(a,b,c){fetch(a).then(function(a){if(b===e.json)return a.json();if(b===e.text)return a.text()}).then(function(a){c(a)}).catch(function(a){message.alertMessage(a,null);console.error(a)})}var e={json:"json",text:"text",html:"html",css:"css",xml:"xml"};return{getComponent:function(a,b,c){a=util.buildUrl(["Lucouse.github.io","component",a,b]);d(a,e.text,function(a){c(a)})},getComponentList:function(a){var b=util.buildUrl(["Lucouse.github.io","list.json"]);d(b,e.json,function(c){a(c)})},
download:d,getProjectInfo:function(a){var b=util.buildUrl(["Lucouse.github.io","project.json"]);d(b,e.json,function(c){a(c)})}}},api=new Api,Util=function(){function d(a){var b=(new JSZip).folder(a.folder.name);b.file(a.folder.file[0].name,a.folder.file[0].value);b.file(a.folder.file[1].name,a.folder.file[1].value);b.generateAsync({type:"base64"}).then(function(a){location.href="data:application/zip;base64,"+a})}function e(a,b){var c="",f;for(f in a)c=c+a[f]+";";b(c)}return{buildDom:function(a){var b=
a.length;a.forEach(function(c,f){f+1<b&&c.appendChild(a[f+1])})},downloadComponent:function(a){api.getComponent(a,"index.html",function(b){api.getComponent(a,"index.css",function(c){d({folder:{name:a,file:[{name:"index.html",value:b},{name:"index.css",value:c}]}})})})},buildZip:d,buildUrl:function(a){var b="";a.forEach(function(a){b=b+"/"+a});return b},buildMailToAddress:function(a,b){var c="MailTo:";e(a.address,function(f){c=c+f+"?";c=c+"subject="+a.subject+"&";e(a.cc,function(f){""!==f&&(c=c+"cc="+
f+"&");e(a.bcc,function(e){""!==f&&(c=c+"bcc="+e+"&"+a.body);c=c+"body="+a.body;b(c)})})})}}},util=new Util;
window.onload=function(d){function e(b){b.forEach(function(b){api.getComponent(b.id,"index.html",function(c){var f=document.createElement("div"),e=document.createElement("h3"),d=document.createElement("div"),h=document.createElement("div");f.setAttribute("class","main-panel");e.innerText=b.name_cn;d.innerHTML=c.replace("index.css","component/"+b.id+"/index.min.css");h.setAttribute("class","component-tooBar");a(h,b.id);c=[document.getElementById("container"),f,e,d,h];util.buildDom(c)})})}function a(a,
c){var b=document.createElement("div"),e=document.createElement("div"),d=document.createElement("i"),g=document.createElement("div"),h=document.createElement("div"),k=document.createElement("i");b.setAttribute("id","icon-panel");d.setAttribute("class","i_download tooltip");d.setAttribute("data-tooltip","\u4e0b\u8f7d");d.onclick=function(a){util.downloadComponent(c)};g.setAttribute("id","icon-panel");k.setAttribute("class","i_feedback tooltip");k.setAttribute("data-tooltip","\u53cd\u9988");var n=document.createElement("a");
util.buildMailToAddress({address:["aaa@a.com","bbb@b.com"],subject:"test",cc:[],bcc:[],body:"test"},function(a){n.setAttribute("href",a)});document.body.appendChild(n);k.onclick=function(a){n.click()};var q=document.createElement("div"),r=document.createElement("div"),l=document.createElement("i");q.setAttribute("id","icon-panel");l.setAttribute("class","i_new_window tooltip");l.setAttribute("data-tooltip","\u65b0\u7a97\u53e3\u6253\u5f00");l.onclick=function(a){cover.showCover();popUp.showPopUp()};
util.buildDom([a,b,e,d]);util.buildDom([a,g,h,k]);util.buildDom([a,q,r,l])}api.getComponentList(function(a){e(a)});api.getProjectInfo(function(a){var b=document.getElementsByClassName("header")[0],d=document.createElement("div"),e=document.createElement("h2"),p=document.createElement("div"),g=document.createElement("div");e.innerText=a.projectName;p.innerText=a.version;g.innerText=a.latestUpdateDate;d.setAttribute("class","project-info");util.buildDom([b,d]);util.buildDom([d,e]);util.buildDom([d,
p]);util.buildDom([d,g])})};
var Cover=function(){var d=document.createElement("div"),e=document.body;return{showCover:function(a){void 0!=a&&(e=a);d.setAttribute("class","cover");e.appendChild(d)},removeCover:function(){e.removeChild(d)}}},cover=new Cover,Message=function(){function d(a){a.fadeOut(800,function(){a.remove()})}function e(a,b){var c=$("<div></div>");b=$("<div></div>");var e=$("<div></div>");b.text("X");c.attr("class","message-container");b.attr("class","message-close");b.click(function(){d(c)});e.html(a);c.append(b);
c.append(e);c.fadeOut(8E3,function(){c.remove()});return c}return{type:{success:"success",error:"error",info:"info",warning:"warning"},alertMessage:function(a,b){$(document.body).append(e(a,b))}}},message=new Message,PopUp=function(){return{showPopUp:function(d,e){cover.showCover();void 0==d&&(d=document.body);var a=document.createElement("div"),b=document.createElement("div"),c=document.createElement("div"),f=document.createElement("div"),m=document.createElement("i");b.setAttribute("class","close-button-container");
c.setAttribute("id","icon-panel");m.setAttribute("class","i_shut");b.appendChild(c).appendChild(f).appendChild(m);void 0!==e?a.setAttribute("class",e):a.setAttribute("class","popUpWin");d.appendChild(a).appendChild(b);m.onclick=function(b){d.removeChild(a);cover.removeCover()}}}},popUp=new PopUp;
