var Api=function(){function e(a,c,b){fetch(a).then(function(b){if(c===d.json)return b.json();if(c===d.text)return b.text()}).then(function(a){b(a)}).catch(function(b){message.alertMessage(b,null);console.error(b)})}var d={json:"json",text:"text",html:"html",css:"css",xml:"xml"};return{getComponent:function(a,c,b){a=util.buildUrl(["Lucouse.github.io","component",a,c]);e(a,d.text,function(a){b(a)})},getComponentList:function(a){var c=util.buildUrl(["Lucouse.github.io","list.json"]);e(c,d.json,function(b){a(b)})},
download:e,getProjectInfo:function(a){var c=util.buildUrl(["Lucouse.github.io","project.json"]);e(c,d.json,function(b){a(b)})}}},api=new Api,Util=function(){function e(a){var c=(new JSZip).folder(a.folder.name);c.file(a.folder.file[0].name,a.folder.file[0].value);c.file(a.folder.file[1].name,a.folder.file[1].value);c.generateAsync({type:"base64"}).then(function(b){location.href="data:application/zip;base64,"+b})}function d(a,c){var b="",f;for(f in a)b=b+a[f]+";";c(b)}return{buildDom:function(a){var c=
a.length;a.forEach(function(b,f){f+1<c&&b.appendChild(a[f+1])})},downloadComponent:function(a){api.getComponent(a,"index.html",function(c){api.getComponent(a,"index.css",function(b){e({folder:{name:a,file:[{name:"index.html",value:c},{name:"index.css",value:b}]}})})})},buildZip:e,buildUrl:function(a){var c="";a.forEach(function(b){c=c+"/"+b});return c},buildMailToAddress:function(a,c){var b="MailTo:";d(a.address,function(f){b=b+f+"?";b=b+"subject="+a.subject+"&";d(a.cc,function(f){""!==f&&(b=b+"cc="+
f+"&");d(a.bcc,function(d){""!==f&&(b=b+"bcc="+d+"&"+a.body);b=b+"body="+a.body;c(b)})})})}}},util=new Util;
window.onload=function(e){function d(c){c.forEach(function(b){api.getComponent(b.id,"index.html",function(c){var f=document.createElement("div"),d=document.createElement("h3"),e=document.createElement("div"),h=document.createElement("div");f.setAttribute("class","main-panel");d.innerText=b.name_cn;e.innerHTML=c.replace("index.css","component/"+b.id+"/index.min.css");h.setAttribute("class","component-tooBar");a(h,b.id);c=[document.getElementById("container"),f,d,e,h];util.buildDom(c)})})}function a(a,
b){var c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("i"),g=document.createElement("div"),h=document.createElement("div"),k=document.createElement("i");c.setAttribute("id","icon-panel");e.setAttribute("class","i_download tooltip");e.setAttribute("data-tooltip","\u4e0b\u8f7d");e.onclick=function(a){util.downloadComponent(b)};g.setAttribute("id","icon-panel");k.setAttribute("class","i_feedback tooltip");k.setAttribute("data-tooltip","\u53cd\u9988");var l=document.createElement("a");
util.buildMailToAddress({address:["aaa@a.com","bbb@b.com"],subject:"test",cc:[],bcc:[],body:"test"},function(a){l.setAttribute("href",a)});document.body.appendChild(l);k.onclick=function(a){l.click()};util.buildDom([a,c,d,e]);util.buildDom([a,g,h,k])}api.getComponentList(function(a){d(a)});api.getProjectInfo(function(a){var b=document.getElementsByClassName("header")[0],c=document.createElement("div"),d=document.createElement("h2"),e=document.createElement("div"),g=document.createElement("div");d.innerText=
a.projectName;e.innerText=a.version;g.innerText=a.latestUpdateDate;c.setAttribute("class","project-info");util.buildDom([b,c]);util.buildDom([c,d]);util.buildDom([c,e]);util.buildDom([c,g])})};
var Cover=function(){var e=document.createElement("div"),d=document.body;return{showCover:function(a){void 0!=a&&(d=a);e.setAttribute("class","cover");d.appendChild(e)},removeCover:function(){d.removeChild(e)}}},cover=new Cover,Message=function(){function e(a){a.fadeOut(800,function(){a.remove()})}function d(a,c){var b=$("<div></div>");c=$("<div></div>");var d=$("<div></div>");c.text("X");b.attr("class","message-container");c.attr("class","message-close");c.click(function(){e(b)});d.html(a);b.append(c);
b.append(d);b.fadeOut(8E3,function(){b.remove()});return b}return{type:{success:"success",error:"error",info:"info",warning:"warning"},alertMessage:function(a,c){$(document.body).append(d(a,c))}}},message=new Message,PopUp=function(){return{showPopUp:function(e){cover.showCover();void 0==e&&(e=document.body);var d=document.createElement("div"),a=document.createElement("div"),c=document.createElement("div"),b=document.createElement("i");a.setAttribute("id","icon-panel");a.setAttribute("class","close-button-container");
b.setAttribute("class","i_shut");a.appendChild(c).appendChild(b);d.setAttribute("class","popUpWin");e.appendChild(d).appendChild(a).appendChild(c).appendChild(b);b.onclick=function(a){e.removeChild(d);cover.removeCover()}}}},popUp=new PopUp;
