var Api=function(){function e(f,a,b){fetch(f).then(function(c){if(a===d.json)return c.json();if(a===d.text)return c.text()}).then(function(a){b(a)}).catch(function(a){message.alertMessage(a,null);console.error(a)})}var d={json:"json",text:"text",html:"html",css:"css",xml:"xml"};return{getComponent:function(f,a,b){f=util.buildUrl(["Lucouse.github.io","component",f,a]);e(f,d.text,function(a){b(a)})},getComponentList:function(f){var a=util.buildUrl(["Lucouse.github.io","list.json"]);e(a,d.json,function(a){f(a)})},
download:e,getProjectInfo:function(f){var a=util.buildUrl(["Lucouse.github.io","project.json"]);e(a,d.json,function(a){f(a)})}}},api=new Api,Util=function(){function e(a){var b=a.length;a.forEach(function(c,g){g+1<b&&c.appendChild(a[g+1])})}function d(a){var b=(new JSZip).folder(a.folder.name);b.file(a.folder.file[0].name,a.folder.file[0].value);b.file(a.folder.file[1].name,a.folder.file[1].value);b.generateAsync({type:"base64"}).then(function(a){location.href="data:application/zip;base64,"+a})}function f(a,
b){var c="",g;for(g in a)c=c+a[g]+";";b(c)}return{buildDom:e,downloadComponent:function(a){api.getComponent(a,"index.html",function(b){api.getComponent(a,"index.css",function(c){d({folder:{name:a,file:[{name:"index.html",value:b},{name:"index.css",value:c}]}})})})},buildZip:d,buildUrl:function(a){var b="";a.forEach(function(a){b=b+"/"+a});return b},buildMailToAddress:function(a,b){var c="MailTo:";f(a.address,function(g){c=c+g+"?";c=c+"subject="+a.subject+"&";f(a.cc,function(g){""!==g&&(c=c+"cc="+
g+"&");f(a.bcc,function(f){""!==g&&(c=c+"bcc="+f+"&"+a.body);c=c+"body="+a.body;b(c)})})})},buildIcon:function(a,b,c){var g=document.createElement("div"),f=document.createElement("div"),d=document.createElement("i");g.setAttribute("id","icon-panel");d.setAttribute("class",b.iconClass+" tooltip");d.setAttribute("data-tooltip",b["data-tooltip"]);for(var h in b.attr)g.setAttribute(b.attr[h].name,b.attr[h].value);e([a,g,f,d]);void 0!==c&&c(d)}}},util=new Util;
window.onload=function(e){function d(a,b){util.buildIcon(a,{iconClass:"i_download","data-tooltip":"\u4e0b\u8f7d"},function(a){a.onclick=function(a){util.downloadComponent(b)}});var c=document.createElement("a");util.buildMailToAddress({address:["aaa@a.com","bbb@b.com"],subject:"test",cc:[],bcc:[],body:"test"},function(a){c.setAttribute("href",a)});document.body.appendChild(c);util.buildIcon(a,{iconClass:"i_feedback","data-tooltip":"\u53cd\u9988"},function(a){a.onclick=function(a){c.click()}});util.buildIcon(a,
{iconClass:"i_open","data-tooltip":"\u65b0\u7a97\u53e3\u6253\u5f00"},function(a){a.onclick=function(a){f(b)}})}function f(a){cover.showCover();var b=document.createElement("div"),c=document.createElement("h3"),g=document.createElement("div"),f=document.createElement("div");b.appendChild(c);b.appendChild(g);b.appendChild(f);g.setAttribute("class","component-detail-content");f.setAttribute("class","popUp-toolbar-container");api.getComponent(a,"index.html",function(d){g.innerHTML=d.replace("index.css",
"component/"+a+"/index.min.css").replace("index.js","component/"+a+"/index.min.js");api.getComponentList(function(b){for(var g in b)if(b[g].id===a){c.innerHTML=b[g].name_cn;var d=void 0,e=b[g].compatibility,m=f,k="",h="",l="";for(d in e){switch(e[d].name){case "weChat":k="i_wechat wechat-icon";h="\u5fae\u4fe1";l=""===e[d].version?"\u672a\u77e5":e[d].version;break;case "chrome":k="i_chrome chrome-icon";h="Chrome";l=""===e[d].version?"\u672a\u77e5":e[d].version;break;case "firefox":k="i_firefox firefox-icon";
h="\u706b\u72d0";l=""===e[d].version?"\u672a\u77e5":e[d].version;break;case "ie":k="i_ie ie-icon";h="IE";l=""===e[d].version?"\u672a\u77e5":e[d].version;break;case "edge":k="i_edge edge-icon",h="Edge",l=""===e[d].version?"\u672a\u77e5":e[d].version}util.buildIcon(m,{iconClass:k,"data-tooltip":h,attr:[{name:"version",value:l}]})}}});popUp.showPopUp(void 0,"custom-popUp-win",b)})}(function(){api.getComponentList(function(a){a.forEach(function(a){api.getComponent(a.id,"index.html",function(b){var c=
document.createElement("div"),f=document.createElement("h3"),e=document.createElement("div"),h=document.createElement("div");c.setAttribute("class","main-panel");f.innerText=a.name_cn;e.innerHTML=b.replace("index.css","component/"+a.id+"/index.min.css").replace("index.js","component/"+a.id+"/index.min.js");h.setAttribute("class","component-tooBar");d(h,a.id);util.buildDom([document.getElementById("container"),c,f]);util.buildDom([c,e]);util.buildDom([c,h])})})})})();(function(){api.getProjectInfo(function(a){var b=
document.getElementsByClassName("header")[0],c=document.createElement("div"),d=document.createElement("a"),f=document.createElement("h2"),e=document.createElement("div"),h=document.createElement("div");f.innerText=a.projectName;e.innerText=a.version;h.innerText=a.latestUpdateDate;c.setAttribute("class","project-info");d.setAttribute("href","https://lucouse.github.io");util.buildDom([b,c]);util.buildDom([c,d,f]);util.buildDom([c,e]);util.buildDom([c,h])})})();(function(){var a=document.getElementsByClassName("footer"),
b=document.createElement("div"),c=document.createElement("ul");c.setAttribute("class","footer-ul");var d=["\u5e2e\u52a9","\u8054\u7cfb\u6211\u4eec"],f;for(f in d){var e=document.createElement("li");e.innerHTML=d[f];c.appendChild(e)}b.appendChild(c);a[0].appendChild(b)})()};
var Cover=function(){var e=document.createElement("div"),d=document.body;return{showCover:function(f){void 0!=f&&(d=f);e.setAttribute("class","cover");d.appendChild(e)},removeCover:function(){d.removeChild(e)}}},cover=new Cover,Message=function(){function e(d){d.fadeOut(800,function(){d.remove()})}function d(d,a){var b=$("<div></div>");a=$("<div></div>");var c=$("<div></div>");a.text("X");b.attr("class","message-container");a.attr("class","message-close");a.click(function(){e(b)});c.html(d);b.append(a);
b.append(c);b.fadeOut(8E3,function(){b.remove()});return b}return{type:{success:"success",error:"error",info:"info",warning:"warning"},alertMessage:function(e,a){$(document.body).append(d(e,a))}}},message=new Message,PopUp=function(){return{showPopUp:function(e,d,f){cover.showCover();void 0==e&&(e=document.body);var a=document.createElement("div"),b=document.createElement("div"),c=document.createElement("div"),g=document.createElement("div"),m=document.createElement("i"),k=document.createElement("div");
b.setAttribute("class","close-button-container");c.setAttribute("id","icon-panel");m.setAttribute("class","i_close close-button-i");b.appendChild(c).appendChild(g).appendChild(m);void 0!==d?a.setAttribute("class",d):a.setAttribute("class","popUpWin");k.setAttribute("class","popUp-content");e.appendChild(a).appendChild(b);a.appendChild(k).appendChild(f);m.onclick=function(b){e.removeChild(a);cover.removeCover()}}}},popUp=new PopUp;
